(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2fe125c6"],{"0d1c":function(e,t,r){"use strict";r.d(t,"q",(function(){return o})),r.d(t,"d",(function(){return n})),r.d(t,"f",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"i",(function(){return d})),r.d(t,"k",(function(){return u})),r.d(t,"b",(function(){return p})),r.d(t,"p",(function(){return f})),r.d(t,"h",(function(){return m})),r.d(t,"n",(function(){return g})),r.d(t,"l",(function(){return h})),r.d(t,"o",(function(){return b})),r.d(t,"m",(function(){return v})),r.d(t,"j",(function(){return _})),r.d(t,"a",(function(){return y}));var a=r("b775"),o="http://api.wuyuefang.top/upload";function n(e){return Object(a["a"])({url:"category",method:"get",params:e})}function i(e){return Object(a["a"])({url:"category/findAll",method:"get",params:e})}function s(e){return Object(a["a"])({url:"category",method:"post",data:e})}function c(e){return Object(a["a"])({url:"category",method:"put",data:e})}function l(e){return Object(a["a"])({url:"category",method:"delete",params:e})}function d(e){return Object(a["a"])({url:"trade/getById",method:"get",params:e})}function u(e){return Object(a["a"])({url:"trade/findLike",method:"get",params:e})}function p(e){return Object(a["a"])({url:"trade/add",method:"post",data:e})}function f(e){return Object(a["a"])({url:"trade",method:"put",data:e})}function m(e){return Object(a["a"])({url:"trade",method:"delete",params:e})}function g(e){return Object(a["a"])({url:"commodityStocks/getStockTwo",method:"get",params:e})}function h(e){return Object(a["a"])({url:"commodityStocks",method:"post",data:e})}function b(e){return Object(a["a"])({url:"commodityStocks",method:"put",data:e})}function v(e){return Object(a["a"])({url:"commodityStocks",method:"delete",params:e})}function _(e){return Object(a["a"])({url:"ptOrder/findByPage",method:"get",params:e})}function y(e){return Object(a["a"])({url:"ptOrder/getTrade/"+e.id,method:"put"})}},1:function(e,t){},10:function(e,t){},2:function(e,t){},"2c36":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-card",{staticClass:"box-card"},[r("h3",[e._v("商品介绍")]),e._v(" "),r("el-form",{ref:"goods",attrs:{rules:e.rules,model:e.goods,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[r("el-input",{model:{value:e.goods.name,callback:function(t){e.$set(e.goods,"name",t)},expression:"goods.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品标题",prop:"title"}},[r("el-input",{model:{value:e.goods.title,callback:function(t){e.$set(e.goods,"title",t)},expression:"goods.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品排序",prop:"sort"}},[r("el-input",{model:{value:e.goods.sort,callback:function(t){e.$set(e.goods,"sort",t)},expression:"goods.sort"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品分类",prop:"categary"}},[r("el-select",{attrs:{placeholder:"选择分类"},model:{value:e.goods.categary,callback:function(t){e.$set(e.goods,"categary",t)},expression:"goods.categary"}},e._l(e.categoryList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"商品封面图片",prop:"picture"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadPath,"show-file-list":!1,headers:e.headers,"before-upload":e.beforePicUrlUpload,accept:".jpg,.jpeg,.png,.gif"}},[e.goods.picUrl?r("img",{staticClass:"avatar",attrs:{src:e.goods.picUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),r("el-form-item",{attrs:{label:"商品详情图片",prop:"detailPic"}},[r("el-upload",{attrs:{action:e.uploadPath,headers:e.headers,"before-upload":e.beforeDetailPicUrlUpload,"on-remove":e.handleRemove,multiple:"",accept:".jpg,.jpeg,.png,.gif","list-type":"picture-card","file-list":e.goods.detailPic}},[r("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),r("el-form-item",{attrs:{label:"轮播图",prop:"banner"}},[r("el-upload",{attrs:{action:e.uploadPath,headers:e.headers,"before-upload":e.beforeBannersUpload,"on-remove":e.handleRemove1,multiple:"",accept:".jpg,.jpeg,.png,.gif","list-type":"picture-card","file-list":e.goods.banners}},[r("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),r("el-form-item",{attrs:{label:"商品售价",prop:"price"}},[r("el-input",{attrs:{type:"number",placeholder:"0.00"},model:{value:e.goods.price,callback:function(t){e.$set(e.goods,"price",t)},expression:"goods.price"}},[r("template",{slot:"append"},[e._v("分")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"已售",prop:"sales"}},[r("el-input",{attrs:{type:"number",placeholder:"0"},model:{value:e.goods.sales,callback:function(t){e.$set(e.goods,"sales",t)},expression:"goods.sales"}},[r("template",{slot:"append"},[e._v("件")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.goods.remark,callback:function(t){e.$set(e.goods,"remark",t)},expression:"goods.remark"}})],1)],1)],1),e._v(" "),r("el-card",{staticClass:"box-card"},[r("h3",[e._v("商品规格")]),e._v(" "),r("el-form",{ref:"specForm",attrs:{rules:e.rules,model:e.specForm,"label-width":"150px"}},[r("el-row",{staticStyle:{padding:"20px 0"},attrs:{gutter:20,type:"flex",align:"middle"}},[r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"规格组和规格值",prop:"trade_color"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入商品颜色"},model:{value:e.specForm.trade_color,callback:function(t){e.$set(e.specForm,"trade_color",t)},expression:"specForm.trade_color"}})],1)],1),e._v(" "),r("el-col",{staticStyle:{"margin-left":"-160px"},attrs:{span:4}},[r("el-form-item",{attrs:{label:"",prop:"trade_size"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入商品尺码"},model:{value:e.specForm.trade_size,callback:function(t){e.$set(e.specForm,"trade_size",t)},expression:"specForm.trade_size"}})],1)],1),e._v(" "),r("el-col",{staticStyle:{"margin-left":"-160px"},attrs:{span:4}},[r("el-form-item",{attrs:{label:"",prop:"trade_num"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{type:"number",placeholder:"请输入商品库存"},model:{value:e.specForm.trade_num,callback:function(t){e.$set(e.specForm,"trade_num",t)},expression:"specForm.trade_num"}},[r("template",{slot:"append"},[e._v("件")])],2)],1)],1),e._v(" "),r("el-col",{staticStyle:{"margin-left":"-160px"},attrs:{span:4}},[r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{plain:!0,type:"primary"},on:{click:e.handleSpecificationAdd}},[e._v("添加")])],1)],1)],1)],1),e._v(" "),r("el-table",{staticStyle:{width:"600px",margin:"30px 0 0 150px"},attrs:{data:e.specifications}},[r("el-table-column",{attrs:{property:"sales",align:"center",label:"库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.trade_num))])]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"color",align:"center",label:"颜色"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.trade_color))])]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"size",align:"center",label:"尺码"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.trade_size))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"操作",width:"250","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){return e.handleSpecificationDelete(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),r("div",{staticClass:"op-container"},[r("el-button",{on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handlePublish}},[e._v("上架")])],1)],1)},o=[],n=r("373c"),i=n["a"],s=(r("fe52"),r("9ca4")),c=Object(s["a"])(i,a,o,!1,null,null,null);t["default"]=c.exports},3:function(e,t){},"373c":function(e,t,r){"use strict";(function(e){r("c904"),r("cc57"),r("9a33"),r("6d57");var a=r("0d1c"),o=r("5f87"),n=r("3c7d");t["a"]={name:"GoodsCreate",data:function(){return{uploadPath:a["q"],goods:{picUrl:"",detailPic:[],banners:[]},specVisiable:!1,specForm:{trade_num:"",trade_color:"",trade_size:""},specifications:[],rules:{title:[{required:!0,message:"请输入商品标题",trigger:"blur"}],name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],sort:[{required:!0,message:"请输入商品排序",trigger:"blur"}],price:[{required:!0,message:"请输入商品售价",trigger:"blur"}],trade_color:[{required:!0,message:"请输入商品颜色",trigger:"blur"}],trade_size:[{required:!0,message:"请输入商品尺码",trigger:"blur"}],trade_num:[{required:!0,message:"请输入商品库存",trigger:"blur"}],picture:[{required:!0,message:"请上传商品图片",trigger:"blur"}],detailPic:[{required:!0,message:"请上传商品详情图片",trigger:"blur"}],banner:[{required:!0,message:"请上传轮播图片",trigger:"blur"}],categary:[{required:!0,message:"请选择商品分类",trigger:"blur"}]},categoryList:[]}},computed:{headers:function(){return{token:Object(o["a"])()}}},created:function(){this.$route.query.trade?this.getGoodsDetail(this.$route.query.trade):(this.goods={name:"",title:"",sort:"",price:"",remark:"",picUrl:"",detailPic:[],banners:[]},this.specifications=[]),this.getCategoryAll()},methods:{getGoodsDetail:function(e){var t=this,r={id:e.id};Object(a["i"])(r).then((function(e){var r=e.data.data,a=[];r.banner_img.split(",").forEach((function(e){var t={name:e,url:e};a.push(t)}));var o=[];r.img.split(",").forEach((function(e){var t={name:e,url:e};o.push(t)})),t.goods={name:r.name,title:r.trade_title,sort:r.trade_sort,categary:r.category_id,picUrl:r.trade_picture,detailPic:o,banners:a,price:r.trade_integral,remark:r.remark},t.getSpecList(r.id)})).catch((function(){t.goods={name:"",title:"",sort:"",price:"",remark:"",picUrl:"",detailPic:[],banners:[]},t.specifications=[]}))},getSpecList:function(e){var t=this,r={tradeId:e};Object(a["n"])(r).then((function(e){t.specifications=e.data.data})).catch((function(){t.specifications=[]}))},getCategoryAll:function(){var e=this;Object(a["d"])().then((function(t){e.categoryList=t.data.data})).catch((function(){e.categoryList=[]}))},init:function(){},handleCancel:function(){this.$router.push({path:"/credits/creditsGoods"})},handlePublish:function(){var e=this,t=[];this.goods.detailPic.forEach((function(e){t.push(e.url)}));var r=[];this.goods.banners.forEach((function(e){r.push(e.url)}));var o={state:0,name:this.goods.name,trade_title:this.goods.title,trade_sort:this.goods.sort,category_id:this.goods.categary,trade_picture:this.goods.picUrl,banner_img:r.join(","),img:t.join(","),trade_integral:this.goods.price,remark:this.goods.remark,trade_spec:this.specifications};this.$route.query.trade?(o.id=this.$route.query.trade.id,Object(a["p"])(o).then((function(t){e.$notify.success({title:"成功",message:"修改成功"}),e.$router.push({path:"/credits/creditsGoods"})})).catch((function(t){e.$notify.error({title:"失败",message:t.data.message})}))):Object(a["b"])(o).then((function(t){e.$notify.success({title:"成功",message:"创建成功"}),e.$router.push({path:"/credits/creditsGoods"})})).catch((function(t){e.$notify.error({title:"失败",message:t.data.message})}))},beforePicUrlUpload:function(t){var r=this,a=this,o={endpoint:"http://bj.bcebos.com",credentials:{ak:"d4f7997db9c74baf96a42483bdfcd558",sk:"33e1fa5a8e6b4c11a0638cad34e85980"}},i="wuyuefang",s=new FileReader;return s.readAsArrayBuffer(t),s.onload=function(s){var c=new e(s.target.result),l=new n["BosClient"](o);l.putObject(i,t.name,c).then((function(e){a.goods.picUrl=o.endpoint+"/"+i+"/"+t.name})).catch((function(){r.$notify.error({title:"失败",message:"封面图上传失败"})}))},!1},beforeDetailPicUrlUpload:function(t){var r=this,a=this,o={endpoint:"http://bj.bcebos.com",credentials:{ak:"d4f7997db9c74baf96a42483bdfcd558",sk:"33e1fa5a8e6b4c11a0638cad34e85980"}},i="wuyuefang",s=new FileReader;return s.readAsArrayBuffer(t),s.onload=function(s){var c=new e(s.target.result),l=new n["BosClient"](o);l.putObject(i,t.name,c).then((function(e){a.goods.detailPic.push({name:o.endpoint+"/"+i+"/"+t.name,url:o.endpoint+"/"+i+"/"+t.name})})).catch((function(){r.$notify.error({title:"失败",message:"商品图上传失败"})}))},!1},beforeBannersUpload:function(t){var r=this,a=this,o={endpoint:"http://bj.bcebos.com",credentials:{ak:"d4f7997db9c74baf96a42483bdfcd558",sk:"33e1fa5a8e6b4c11a0638cad34e85980"}},i="wuyuefang",s=new FileReader;return s.readAsArrayBuffer(t),s.onload=function(s){var c=new e(s.target.result),l=new n["BosClient"](o);l.putObject(i,t.name,c).then((function(e){a.goods.banners.push({name:o.endpoint+"/"+i+"/"+t.name,url:o.endpoint+"/"+i+"/"+t.name})})).catch((function(){r.$notify.error({title:"失败",message:"轮播图上传失败"})}))},!1},handleRemove:function(e,t){for(var r=0;r<this.goods.detailPic.length;r++){var a;a=void 0===e.response?e.url:e.response.data.url,this.goods.detailPic[r].url===a&&this.goods.detailPic.splice(r,1)}},handleRemove1:function(e,t){for(var r=0;r<this.goods.banners.length;r++){var a;a=void 0===e.response?e.url:e.response.data.url,this.goods.banners[r].url===a&&this.goods.banners.splice(r,1)}},handleSpecificationAdd:function(){this.specForm.trade_color&&this.specForm.trade_size&&this.specForm.trade_num?(this.specifications.push(this.specForm),this.specForm={}):this.$message({type:"error",message:"请填写规格"})},handleSpecificationDelete:function(e){var t=this.specifications.indexOf(e);this.specifications.splice(t,1)}}}}).call(this,r("fd40").Buffer)},4:function(e,t){},5:function(e,t){},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){},a2cd:function(e,t,r){"use strict";var a=r("238a");e.exports=function(e,t){return!!e&&a((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},c904:function(e,t,r){"use strict";var a=r("e46b"),o=r("5daa"),n=r("008a"),i=r("238a"),s=[].sort,c=[1,2,3];a(a.P+a.F*(i((function(){c.sort(void 0)}))||!i((function(){c.sort(null)}))||!r("a2cd")(s)),"Array",{sort:function(e){return void 0===e?s.call(n(this)):s.call(n(this),o(e))}})},cf36:function(e,t,r){},fe52:function(e,t,r){"use strict";var a=r("cf36"),o=r.n(a);o.a}}]);